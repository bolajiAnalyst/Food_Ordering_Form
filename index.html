<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Food Order Form</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background-color: #f9fafb;
      color: #1f2937;
    }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

  <!-- Main Container -->
  <div class="bg-white p-8 rounded-2xl shadow-lg w-full max-w-2xl border border-gray-200">
    <h1 class="text-3xl font-bold text-center mb-4 text-gray-800">Salaam Food Hub</h1>
    <p class="text-center text-gray-500 mb-8 text-sm sm:text-base">Fill out the form below to place your order. Your order will be processed instantly!</p>

    <!-- Order Form -->
    <form id="orderForm" class="space-y-6">
      <!-- Name and Email -->
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
        <div>
          <label for="customerName" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
          <input type="text" id="customerName" name="customerName" required
                 class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition">
        </div>
        <div>
          <label for="customerEmail" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
          <input type="email" id="customerEmail" name="customerEmail" required
                 class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition">
        </div>
      </div>

      <!-- Food Type Selection -->
      <div>
        <span class="block text-sm font-medium text-gray-700 mb-2">Food Type</span>
        <div class="flex flex-col sm:flex-row gap-3">
          <label class="flex items-center space-x-2 cursor-pointer bg-gray-100 p-3 rounded-lg border border-gray-200 hover:bg-gray-200 transition w-full sm:w-auto">
            <input type="radio" name="foodType" value="vegetarian" required class="form-radio text-green-500 focus:ring-green-500">
            <span>Vegetarian</span>
          </label>
          <label class="flex items-center space-x-2 cursor-pointer bg-gray-100 p-3 rounded-lg border border-gray-200 hover:bg-gray-200 transition w-full sm:w-auto">
            <input type="radio" name="foodType" value="non-vegetarian" required class="form-radio text-red-500 focus:ring-red-500">
            <span>Non-Vegetarian</span>
          </label>
        </div>
      </div>
      
      <!-- Food Item Lists -->
      <div id="foodLists" class="space-y-4">
        <!-- Vegetarian -->
        <div id="vegetarianList" class="hidden">
          <span class="block text-sm font-medium text-gray-700 mb-2">Select Vegetarian Items:</span>
          <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
            <label class="flex items-center space-x-2"><input type="checkbox" name="vegItems" value="fruits" class="rounded text-indigo-600"><span>Fruits</span></label>
            <label class="flex items-center space-x-2"><input type="checkbox" name="vegItems" value="vegetables" class="rounded text-indigo-600"><span>Vegetables</span></label>
            <label class="flex items-center space-x-2"><input type="checkbox" name="vegItems" value="grains" class="rounded text-indigo-600"><span>Grains</span></label>
            <label class="flex items-center space-x-2"><input type="checkbox" name="vegItems" value="nuts" class="rounded text-indigo-600"><span>Nuts</span></label>
            <label class="flex items-center space-x-2"><input type="checkbox" name="vegItems" value="seeds" class="rounded text-indigo-600"><span>Seeds</span></label>
          </div>
        </div>

        <!-- Non-Vegetarian -->
        <div id="nonVegetarianList" class="hidden">
          <span class="block text-sm font-medium text-gray-700 mb-2">Select Non-Vegetarian Items:</span>
          <div class="grid grid-cols-2 sm:grid-cols-3 gap-3">
            <label class="flex items-center space-x-2"><input type="checkbox" name="nonVegItems" value="beef" class="rounded text-indigo-600"><span>Beef</span></label>
            <label class="flex items-center space-x-2"><input type="checkbox" name="nonVegItems" value="chicken" class="rounded text-indigo-600"><span>Chicken</span></label>
            <label class="flex items-center space-x-2"><input type="checkbox" name="nonVegItems" value="fish" class="rounded text-indigo-600"><span>Fish</span></label>
            <label class="flex items-center space-x-2"><input type="checkbox" name="nonVegItems" value="eggs" class="rounded text-indigo-600"><span>Eggs</span></label>
          </div>
        </div>
      </div>

      <!-- Submit Button -->
      <button type="submit"
              class="w-full flex justify-center items-center py-3 px-4 rounded-lg bg-indigo-600 text-white font-semibold shadow-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform transform hover:scale-105">
        Place Order
      </button>
    </form>

    <!-- Status Message -->
    <div id="statusMessage" class="mt-6 text-center text-sm font-medium p-4 rounded-lg hidden transition-all duration-300"></div>
  </div>

  <!-- JavaScript -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('orderForm');
      const statusMessage = document.getElementById('statusMessage');
      const foodTypeInputs = document.querySelectorAll('input[name="foodType"]');
      const vegetarianList = document.getElementById('vegetarianList');
      const nonVegetarianList = document.getElementById('nonVegetarianList');

      const webhookUrl = "https://hook.eu2.make.com/7qk5h8eb7k8mqrz4ymsa6wvpmbggemku"; 

      // Toggle food lists
      const toggleFoodLists = () => {
        const selectedFoodType = document.querySelector('input[name="foodType"]:checked')?.value;
        vegetarianList.classList.add('hidden');
        nonVegetarianList.classList.add('hidden');
        if (selectedFoodType === 'vegetarian') vegetarianList.classList.remove('hidden');
        if (selectedFoodType === 'non-vegetarian') nonVegetarianList.classList.remove('hidden');
      };
      foodTypeInputs.forEach(input => input.addEventListener('change', toggleFoodLists));

      // Submit
      form.addEventListener('submit', async (event) => {
        event.preventDefault();
        statusMessage.classList.add('hidden');

        const foodType = document.querySelector('input[name="foodType"]:checked')?.value;
        let selectedItems = [];
        if (foodType === 'vegetarian') {
          selectedItems = Array.from(document.querySelectorAll('input[name="vegItems"]:checked')).map(i => i.value);
        } else if (foodType === 'non-vegetarian') {
          selectedItems = Array.from(document.querySelectorAll('input[name="nonVegItems"]:checked')).map(i => i.value);
        }

        if (selectedItems.length === 0) {
          statusMessage.textContent = "Please select at least one food item.";
          statusMessage.className = "mt-6 text-center text-sm font-medium p-4 rounded-lg bg-red-100 text-red-700";
          statusMessage.classList.remove('hidden');
          return;
        }

        const orderData = {
          customer_name: document.getElementById('customerName').value,
          customer_email: document.getElementById('customerEmail').value,
          food_type: foodType,
          order_items: selectedItems,
          order_id: Math.random().toString(36).substring(2, 11)
        };

        try {
          // Show spinner
          statusMessage.innerHTML = `
            <div class="flex items-center justify-center space-x-2">
              <svg class="animate-spin h-5 w-5 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v8H4z"></path>
              </svg>
              <span>Processing your order...</span>
            </div>
          `;
          statusMessage.className = "mt-6 text-center text-sm font-medium p-4 rounded-lg bg-blue-100 text-blue-700";
          statusMessage.classList.remove('hidden');

          const response = await fetch(webhookUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(orderData),
          });

          const result = await response.json();

          if (response.ok) {
            statusMessage.textContent = result.message || "Order placed successfully!";
            statusMessage.className = "mt-6 text-center text-sm font-medium p-4 rounded-lg bg-green-100 text-green-700";
            form.reset();
            toggleFoodLists();
          } else {
            throw new Error(`Server responded with status: ${response.status}`);
          }
        } catch (error) {
          console.error('Error submitting order:', error);
          statusMessage.textContent = "Failed to place order. Please try again.";
          statusMessage.className = "mt-6 text-center text-sm font-medium p-4 rounded-lg bg-red-100 text-red-700";
        }
      });
    });
  </script>
</body>
</html>
